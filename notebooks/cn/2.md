# 二、线程简介

## 概念

### 多任务

看起来很多任务在一起做，实际上同一时间只在做一个事情。

> 多任务处理是指用户可以在同一时间内运行多个应用程序,每个应用程序被称作一个任务.Linux、windows就是支持多任务的操作系统,比起单任务系统它的功能增强了许多。
> 
> 当多任务操作系统使用某种任务调度策略允许两个或更多进程并发共享一个处理器时，事实上处理器在某一时刻只会给一件任务提供服务。因为任务调度机制保证不同任务之间的切换速度十分迅速，因此给人多个任务同时运行的错觉。多任务系统中有3个功能单位：任务、进程和线程。

### 多线程

多条路同时执行

> 多线程（multithreading），是指从软件或者硬件上实现多个线程并发执行的技术。具有多线程能力的计算机因有硬件支持而能够在同一时间执行多于一个线程，进而提升整体处理性能。具有这种能力的系统包括对称多处理机、多核心处理器以及芯片级多处理或同时多线程处理器。在一个程序中，这些独立运行的程序片段叫作“线程”（Thread），利用它编程的概念就叫作“多线程处理”

### 程序 进程 线程

程序：运行在进程就是程序。
> 程序是指令和数据的有序集合，其本身没有任何运行的含义，是一个静态的概念。

进程（Process）：运行的程序就是进程。
> 进程是执行程序的一次执行过程，他是一个动态的概念。是系统资源分配的单位。

线程（Thread）：线程内的多个部分就是线程。
> 通常在一个进程中包含若干个线程，当然一个进程中必须有至少一个线程，不然没有存在的意义。

线程是CPU调度和执行的单位

### 核心概念

* 线程就是独立执行的路径
* 在程序运行时，即使没有自己创建线程，后台也会有多个线程，例如main线程、GC线程
* `main()`称为主线程，为系统的入口，用于执行整个程序
* 在一个进程中，如果开辟了多个线程，线程的运行由调度器安排调度，调度器是与操作系统紧密相关的，先后顺序是不能人为干预的
* 对同一份资源操作时，会存在资源抢夺的问题，需要加入并发控制
* 线程会带来额外的开销，例如CPU调度时间、并发控制开销
* 每个线程在自己的工作内存交互，内存控制不当就会造成数据不一致